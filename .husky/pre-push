# Run Pulumi preview to catch infrastructure errors before push
echo "üîç Running Pulumi preview..."

# Check if Pulumi is available
if ! command -v pulumi &> /dev/null; then
  echo "‚ö†Ô∏è  Pulumi not found, skipping preview"
  exit 0
fi

# Run preview from repository root (Pulumi.yaml is now at root)
if ! pulumi preview --non-interactive --suppress-outputs; then
  echo "‚ùå Pulumi preview failed! Fix errors before pushing."
  exit 1
fi

echo "‚úÖ Pulumi preview passed"
